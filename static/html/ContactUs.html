<!DOCTYPE html>
<html lang="en">
<head>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel = "icon" href ="../img/GiftPrintSmall.png" type = "image/x-icon">
        <script src="../js/contactUs.js"></script>
        <script src="../js/util.js"></script>

        <link rel="stylesheet" type="text/css" href="../css/NavBar.css">
        <link rel="stylesheet" type="text/css" href="../css/contactUs.css">
        <nav id="navBar"></nav>
        <script>navBar(false)</script>

    <title>Contact Us</title>
</head>
<body>
<h4 style="text-align: center">Please leave a message and we will answer as soon as possible</h4>
<div class="chat-container" id="chat-container">
    <div class="messages" id="messages"> </div>

    <div class="msg-input">
        <textarea id="user-msg" oninput="styleButton(this)"></textarea>
        <button id="send-msg" onclick="sendMsg()" disabled>Send</button>
    </div>
</div>

<div id="chatWindow" style="border: #0d0d0d 3px solid; height:100px"></div>
<input type="text" id="msgBox">

</body>
<script>
    let socket;
    window.onload= function(){
        socket = new WebSocket("ws://localhost:8080/api/contactUs/ws")
        console.log("sending from ws://localhost:8080/api/contactUs/ws")
        socket.onmessage = handleMessage;
        document.getElementById("msgBox").onkeydown = handleKeyPress;
    }

    function handleMessage(msg){
        let elem = document.createElement('div');
        elem.innerHTML = msg.data
        document.getElementById('chatWindow').appendChild(elem)
    }
    function handleKeyPress(e){
        if(e.keyCode === 13){
            let text = document.getElementById('msgBox').value;
            document.getElementById('msgBox').value = "";
            socket.send(text)
            console.log("sending")
        }
    }
    window.onbeforeunload = function(){
        socket.close();
    }

</script>
</html>